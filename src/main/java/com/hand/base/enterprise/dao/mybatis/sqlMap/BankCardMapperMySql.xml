<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hand.base.enterprise.dao.mybatis.mapper.BankCardMapper">
	<resultMap type="com.hand.base.enterprise.model.BankCard"
		id="bankCard"></resultMap>

	<sql id="queryAllSql">
		SELECT
		T1.ROW_ID id
		,T1.CREATED created
		,T1.CREATED_BY as createdBy
		,DATE_FORMAT(T1.LAST_UPD, '%Y-%m-%d %H:%i:%S') as lastUpdated
		,T1.LAST_UPD_BY as lastUpdatedBy
		,T1.O2O_CONTACT contact /*联系人*/
		,t1.O2O_CONTACT_PHONE contactPhone /*预留手机号*/
		,t1.O2O_ACCONT_NAME o2oAccntName/*开户人*/
		,t1.O2O_BANK bank /*开户银行*/
		,t1.O2O_CREDIT_CARD creaitCard /*银行卡号*/
	</sql>
	
	<sql id="fromTableSql">
	FROM lnk_accnt t1
	WHERE 1=1
	</sql>
	
	<sql id="whereAllSql">
		and t1.corp_id = #{usercorpid}
		and t1.acct_type = 'bank'
	</sql>
	
	<sql id="orderByAllSql">
		
	</sql>	
	
	<!-- 记录总数 -->
	<select id="queryCountByExample" resultType="java.lang.Integer" parameterType="com.hand.base.enterprise.model.BankCard">
		SELECT count(1)
		<include refid="fromTableSql"/>
		<include refid="whereAllSql"/>
	</select>
	
	<select id="queryByExamplePage" resultMap="bankCard"
		parameterType="com.hand.base.enterprise.model.BankCard">
		<include refid="queryAllSql"/>
		<include refid="fromTableSql"/>
		<include refid="whereAllSql"/>
		order by t1.CREATED desc
	</select>
	<select id="brandQueryByExamplePage" resultMap="bankCard"
		parameterType="com.hand.base.enterprise.model.BankCard">
		<include refid="queryAllSql"/>
		<include refid="fromTableSql"/>
		<include refid="whereAllSql"/>
		order by t1.CREATED desc
	</select>
	
	<select id="queryById" resultMap="bankCard"
		parameterType="com.hand.base.enterprise.model.BankCard">
		<include refid="queryAllSql"/>
		<include refid="fromTableSql"/>
		<include refid="whereAllSql"/>
		and T1.ROW_ID=#{id}
	</select>
	
	<select id="brandQueryById" resultMap="bankCard"
		parameterType="com.hand.base.enterprise.model.BankCard">
		<include refid="queryAllSql"/>
		<include refid="fromTableSql"/>
		<include refid="whereAllSql"/>
		and T1.ROW_ID=#{id}
	</select>
	
	<insert id="insert" parameterType="com.hand.base.enterprise.model.BankCard">
		insert into lnk_accnt (
			row_id
			,O2O_CONTACT
			,O2O_CONTACT_PHONE
			,O2O_ACCONT_NAME
			,O2O_BANK
			,O2O_CREDIT_CARD
			,acct_type
			) VALUES (
			#{id}
			,#{contact}
			,#{contactPhone}
			,#{o2oAccntName}
			,GET_LOV_val(#{usercorpid},'TB_O2O_BANK',#{bank})
			,#{creaitCard}
			,'bank'
			)
	</insert>
	
	<insert id="brandInsert" parameterType="com.hand.base.enterprise.model.BankCard">
		insert into lnk_accnt (
			row_id
			,O2O_CONTACT
			,O2O_CONTACT_PHONE
			,O2O_ACCONT_NAME
			,O2O_BANK
			,O2O_CREDIT_CARD
			,acct_type
			) VALUES (
			#{id}
			,#{contact}
			,#{contactPhone}
			,#{o2oAccntName}
			,GET_LOV_val(#{usercorpid},'TB_O2O_BANK',#{bank})
			,#{creaitCard}
			,'bank'
			)
	</insert>
	
	<update id="update" parameterType="com.hand.base.enterprise.model.BankCard">
		update lnk_accnt
		set row_id=#{id}
		<if test=" contact != null and contact != '' ">
		,O2O_CONTACT=#{contact} /*联系人*/
		</if>
		<if test=" contactPhone != null and contactPhone != '' ">
		,O2O_CONTACT_PHONE =#{contactPhone} /*联系电话*/
		</if>
		<if test=" o2oAccntName != null and o2oAccntName != '' ">
		,O2O_ACCONT_NAME =#{o2oAccntName}/*开户人*/
		</if>
		<if test=" bank != null and bank != '' ">
		,O2O_BANK =GET_LOV_val(#{usercorpid},'TB_O2O_BANK',#{bank}) /*开户银行*/
		</if>
		<if test=" creaitCard != null and creaitCard != '' ">
		,O2O_CREDIT_CARD =#{creaitCard} /*银行卡号*/
		</if>
		,acct_type = 'bank'
		where row_id=#{id}
		
	</update>
	
	<update id="brandUpdate" parameterType="com.hand.base.enterprise.model.BankCard">
		update lnk_accnt
		set row_id=#{id}
		<if test=" contact != null and contact != '' ">
		,O2O_CONTACT=#{contact} /*联系人*/
		</if>
		<if test=" contactPhone != null and contactPhone != '' ">
		,O2O_CONTACT_PHONE =#{contactPhone} /*联系电话*/
		</if>
		<if test=" o2oAccntName != null and o2oAccntName != '' ">
		,O2O_ACCONT_NAME =#{o2oAccntName}/*开户人*/
		</if>
		<if test=" bank != null and bank != '' ">
		,O2O_BANK =GET_LOV_val(#{usercorpid},'TB_O2O_BANK',#{bank}) /*开户银行*/
		</if>
		<if test=" creaitCard != null and creaitCard != '' ">
		,O2O_CREDIT_CARD =#{creaitCard} /*银行卡号*/
		</if>
		,acct_type = 'bank'
		where row_id=#{id}
	</update>
	
	
</mapper>
